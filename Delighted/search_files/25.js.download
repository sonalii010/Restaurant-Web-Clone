"use strict";(self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[]).push([[25],{1444:(e,t,n)=>{n.d(t,{a:()=>E});var a=n(0),i=n(181),r=n(1087),o=n(159),s=n(56),c=n(14),d=n(49),l=n(76),u=n(861),f=n(376),p=n(604),m=n(370),_=n(684),h=n(777),b=n(161),g=n(2),v=n(778),y=n(293),S=n(668),D=n(18),I=n(775),x=g.a.isActivated("937A3141-0674-4F3C-B6F6-AACCD3BFD1DD","07/12/2024","Disable collect sp perf metrics for Image tagging"),C=g.a.isActivated("C8FBDDAA-10A4-401C-AF53-DB24C9FE508B","10/27/2024","always use form digest for COB"),O="undefined"!=typeof window?window:void 0,w=O&&O.performance,E=function(){function e(e,t){var n,a,i,r,c,d,l,u,f,p;this._dataRequestorContext=t.dataRequestorContext,this._tokenProvider=null!==(n=null==t?void 0:t.tokenProvider)&&void 0!==n?n:null===(a=this._dataRequestorContext)||void 0===a?void 0:a.tokenProvider,this._dataSyncClient=null!==(i=null==t?void 0:t.dataSyncClient)&&void 0!==i?i:null===(r=this._dataRequestorContext)||void 0===r?void 0:r.dataSyncClient,this._qosName=e.qosName,this._apiEvent=null!==(c=null==t?void 0:t.apiEvent)&&void 0!==c?c:o.a,this._engagement=null!==(d=null==t?void 0:t.engagement)&&void 0!==d?d:s.a,this._normalizeErrors=null===(l=e.normalizeErrors)||void 0===l||l,this._getDataWithTokenProvider=null!==(u=null==t?void 0:t.getDataWithTokenProvider)&&void 0!==u?u:v.a,this._getDataWithSyncClient=null!==(f=null==t?void 0:t.getDataWithSyncClient)&&void 0!==f?f:h.a,this._offlineDetection=null==t?void 0:t.offlineDetection,this._noRedirect=null===(p=null==t?void 0:t.noRedirect)||void 0===p||p}return e.parseJSON=function(e){return e&&JSON.parse(e)||void 0},e.prototype.getData=function(e){var t=e.cancelToken,n=this._getData(e);if(t){var a=t.subscribe(function(){n.cancel()});return Promise.resolve(n).then(function(e){return a(),e}).catch(function(e){throw a(),e})}return Promise.resolve(n)},e.prototype._getData=function(t){var n=this,o=t.parseResponse,s=void 0===o?e.parseJSON:o,h=t.qosExtraData,v=t.additionalPostData,E=void 0===v?"":v,A=t.contentType,L=t.method,k=void 0===L?"POST":L,M=t.maxRetries,P=void 0===M?0:M,T=t.responseType,U=t.onUploadProgress,F=t.timeout,H=t.noTimeoutInLastRetry,R=void 0!==H&&H,N=t.webAbsoluteUrl,B=t.allowOAuth,j=void 0===B||B,V=t.customerPromise,z=t.url,G=t.maxUrlLength,K=void 0===G?2e3:G,W=t.onBeforeRequest;if(z.length>K)throw new f.a({errorData:{code:"".concat(S.a,",").concat(p.h),status:-1}});var q=this._dataRequestorContext,Q=this._tokenProvider,Y=this._getDataWithTokenProvider,J=this._getDataWithSyncClient,X=[];this._qosName&&X.push(this._qosName),t.qosName&&X.push(t.qosName);var Z=X.join("."),$=function(e){var o=e.url,v=e.telemetryHandler,S=e.authToken,L=e.useExactAuthToken,M=void 0!==L&&L,H=e.additionalHeaders,B=!0,z=new l.a(o),G="".concat(z.authority,"/{ length: ").concat(z.path.length,", segments: ").concat(z.segments.length," }"),K=function(e){var S=e.authToken,L=e.qosExtraData,z=t.crossSiteCollectionCall,K=void 0!==z&&z,Y=t.noRedirect,J=void 0===Y?n._noRedirect:Y,X=t.needsRequestDigest,$=void 0===X||X,ee=(0,a.__assign)((0,a.__assign)((0,a.__assign)({},t.additionalHeaders),H),x||"ODSDataSource.ODSP.ImageTag.Feedback.UploadImage"!==Z?{CollectSPPerfMetrics:m.b.sqlQueryCount}:{});if(j&&S){var te=!1;b.a.isFeatureEnabled({ECS:86137})||S.split(" ").length>1&&(te=!0);var ne=M||te?S:"Bearer ".concat(S),ae=!1;for(var ie in ee)ie&&"authorization"===ie.toLowerCase()&&(ae=!0);ae||(ee.Authorization=ne),K=!0,!C&&function(e){return!(!e||"ConsumerTenant"!==e.tenantDisplayName||0!==e.webAbsoluteUrl.indexOf("https://my.microsoftpersonalcontent.com"))}(q)||($=!1),J=!0}else j&&(I.a&&I.b||!Q||Q&&(ee.Authorization="Bearer"));var re,oe,se=new _.a((0,a.__assign)((0,a.__assign)({},q?{webServerRelativeUrl:q.webServerRelativeUrl,webAbsoluteUrl:N||q.webAbsoluteUrl,alwaysGetDigest:K,formDigest:{serverTime:q.serverTime,updateFormDigestPageLoaded:q.updateFormDigestPageLoaded,formDigestValue:q.formDigestValue,formDigestTimeoutSeconds:q.formDigestTimeoutSeconds}}:{}),{needsRequestDigest:$,engagement:n._engagement,operationName:n._qosName})),ce=O&&O.location&&new l.a(O.location.href).authority,de=new l.a(o).authority;return null==W||W(),function(e){var t=e.onExecute,n=e.onCancel,a=e.timeout,i=e.canRetry,o=e.noTimeoutInLastRetry,s=0,c=Math.max(e.maxRetries,0),d=function(){var e=new D.a(t,function(){n(s>=c||!i())});return a&&(!o||s<c)?D.a.timeout(a,e):e};return s<c?(0,r.a)({canRetry:i,retries:c,callback:d,beforeRetry:function(){s++}}):d()}({timeout:F,onExecute:function(e,t){var r=function(r,d){return function(l){var p=l.getResponseText();oe=l.getServiceWorkerDataSourceHeader();var _,b,g,y,D=(0,u.a)(o,d),I=(0,a.__assign)((0,a.__assign)((0,a.__assign)((0,a.__assign)({},h||{}),{needsRequestDigest:$,hasAuthToken:!!S,isCrossOrigin:!!ce&&ce!==de,CorrelationId:l.getCorrelationId()}),L||{}),{HttpStatus:l.getStatus(),serviceWorkerDataSource:oe||void 0,rawRequestDuration:D.duration,performanceEntry:JSON.stringify(D),serviceWorkerFetchInfo:l.getResponseHeader(m.b.serviceWorkerFetchInfo)||void 0,SQLRT:l.getHeaderNumberValue(m.b.sqlQueryCount),ServerDuration:l.getHeaderNumberValue(m.b.serverDuratrion)}),x=!1;try{!function(e,t){return"blob"===e&&!!t&&"object"==typeof t}(T,p)?b=s(p,l):g=p,x=!0}catch(e){_=e,y={resultType:c.b.Failure,resultCode:"InvalidJSON",error:(0,i.d)("object"==typeof e?JSON.stringify(e):e,!1),extraData:I}}if(y||(y={resultType:c.b.Success,extraData:I}),v&&(y=v({response:b,eventData:y,serverData:l}).eventData),null==r||r.end(y),x)try{e(g||b)}catch(e){}else t(n._normalizeErrors?new f.a({code:"-1,parse_response",innerError:_,errorData:{correlationId:l.getCorrelationId(),status:l.getStatus()}}):void 0);se=void 0}},l=function(e,r){return function(s,l){var _=(0,u.a)(o,r),b=(0,a.__assign)((0,a.__assign)({},h||{}),{needsRequestDigest:$,hasAuthToken:!!S,isCrossOrigin:!!ce&&ce!==de,rawRequestDuration:_.duration,performanceEntry:JSON.stringify(_)}),y="undefined"!=typeof navigator&&!1===navigator.onLine;if(n._offlineDetection&&(y=n._offlineDetection.offline),!s){var D=p.g,I=!0,x=0;l&&l instanceof d.a&&(D=l.code,I=l.isExpected,x=-1),!y||D!==p.d&&D!==p.g||(D=p.e);var C={status:x,code:D},O={resultType:I?c.b.ExpectedFailure:c.b.Failure,resultCode:D,extraData:b};return v&&(O=v({eventData:O,errorData:C}).eventData),null==e||e.end(O),void t(n._normalizeErrors?new f.a({errorData:C,innerError:l}):C)}var w=function(r){var o=void 0,d=function(e){var t=!1,n={order:[],map:{}},a=e.getResponseHeader(m.b.msDiagnostics);if(a)try{var i=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?/.exec(a),r=i[1],o=void 0===r?"-1":r,s=i[2],c=void 0===s?"":s,d=i[3],l=void 0===d?"unknown":d;switch(Number(o)){case 3e6:case 3000003:case 3000006:case 3001003:case 3001004:case 3001005:case 3002e3:case 3004009:case 3004010:case 3003e3:t=!0;break;default:t=!1}var u={source:m.b.msDiagnostics,code:"".concat(o,",").concat(l),message:c,isDisplayable:!0};n.order.push(u.source),n.map[u.source]=u}catch(e){}var f=e.getResponseHeader(m.b.webDavExtError);if(f)try{var p=/(\d+);\s+(.+)/.exec(f),_=p[1],h=void 0===_?"-1":_,b=p[2];c=void 0===b?"":b,u={source:m.b.webDavExtError,code:h,message:c,isDisplayable:!1},n.order.push(u.source),n.map[u.source]=u}catch(e){}var g=e.getResponseHeader(m.b.spoErrorCode);if(g){var v=e.getResponseHeader(m.b.spoErrorMessage);u={source:m.b.spoErrorCode,code:g,message:v,isDisplayable:!0},n.order.push(u.source),n.map[u.source]=u}var y=e.getResponseHeader(m.b.subStatusCode);return y&&(u={source:m.b.subStatusCode,code:y},n.order.push(u.source),n.map[u.source]=u),{codes:n,isExpected:t}}(s),l=null==d?void 0:d.isExpected,u=null==d?void 0:d.codes;if("object"==typeof r&&"number"==typeof r.status)o=r;else if("string"==typeof r){var _=void 0;try{_=JSON.parse(r)}catch(e){}if(_)if(_.error_description)o={code:"-1,".concat(_.error||"Unknown"),message:_.error_description},"policy_enforced"===_.error&&(l=!0);else if("string"==typeof _.error)o={message:_.error};else if(_.error&&_.error.message&&_.error.message.value){var h={source:f.b.spServiceResponse,code:_.error.code,message:"".concat(_.error.message.value),isDisplayable:!0};u&&(u.order.push(h.source),u.map[h.source]=h),o=_.error}else o=_.error||_["odata.error"]||{responseData:_};else if(r&&400===s.getStatus()){var S;S=function(e){return/<html[^>]*>[\s\S]*?<body[^>]*>[\s\S]*?<\/body>[\s\S]*?<\/html>/i.test(e)}(r)?function(e){var t=e.match(/<body[^>]*>[\s\S]*<\/body>/i);return t?t[0]:""}(r).slice(0,1e3):r.slice(0,1e3),o={code:"-1,HTMLResult",message:S},b=(0,a.__assign)((0,a.__assign)({},b),{rawPayload:E})}}var D=s.getStatus(),I=s.getCorrelationId(),x=s.getResponseHeader(m.b.spGroupThrottle),C=s.getResponseHeader(m.b.webDavExtError);if(b=(0,a.__assign)((0,a.__assign)({},b),{CorrelationId:I,HttpStatus:D,GroupThrottle:x,MSCorrelationVector:s.getResponseHeader(m.b.correlationVector)}),(401===D&&C||403===D||404===D||429===D||503===D||-1===D||0===D&&y)&&(B=!1,l=!0),400===D){var O=function(e){var t,n={order:[],map:{}},a="No X-Msedge-Ref details",i=e.getResponseHeader(m.b.msEdgeRef);return i?t={source:m.b.subStatusCode,code:"Non-Empty X-Msedge-Ref details",message:i}:g.a.isActivated("44F48045-1E39-41C1-962A-7F04F8093447")&&(t={source:m.b.subStatusCode,code:a,message:a}),t&&(n.order.push(t.source),n.map[t.source]=t),{codes:n,isExpected:!1}}(s);u&&O&&(Array.prototype.push.apply(u.order,O.codes.order),O.codes.order.forEach(function(e){u.map[e]=O.codes.map[e]})),b.rawPayload||(b=(0,a.__assign)((0,a.__assign)({},b),{rawPayload:E}))}(o=o||{}).codes=u,o.status=D,o.retryAfter=s.getHeaderNumberValue(m.b.retryAfter),o.authenticate=s.getResponseHeader(m.b.authenticate),o.authenticate&&(l=!0),I&&(o.correlationId=I),x&&(o.groupThrottle=x);var w=JSON.stringify(o);g.a.isActivated("C17CE162-3524-444F-85D5-8B5A0AA35544")||(o.targetUrl=s.getSourceUrl());var A=o["@error.redirectUrl"],L=s.getRedirectUrl()||A;L&&(l=!0,o.redirectUrl=L);var k=null==u?void 0:u.map[f.b.spServiceResponse];k&&n._normalizeErrors&&(o.message=k.message);var M=null==u?void 0:u.order[0];M&&(h=u.map[M])&&(M===m.b.spoErrorCode&&h.message?(o.code=p.a,o.message=h.message):h.code&&(o.code=h.code)),o.code||(o.code=p.g);var P="[".concat(D,"] ").concat(o.code),T={resultType:l?c.b.ExpectedFailure:c.b.Failure,error:(0,i.d)(w,!1),resultCode:P,extraData:b};if(v){var U=v({eventData:T,errorData:o,serverData:s}),F=U.eventData,H=U.canRetry;F&&(T=F),!0!==H&&!1!==H||(B=H),T.resultType===c.b.ExpectedFailure&&(l=!0)}var R=n._normalizeErrors?new f.a({errorData:o,isExpected:l}):o;R.codes&&R.codes&&(T.extraData||(T.extraData={}),T.extraData.errorCodes=JSON.stringify(R.codes.map)),null==e||e.end(T),t(R)},A=s.getResponseType();A&&"text"!==A?s.parseError().then(w):w(s.getResponseText())}};!function(){var e;e=re=V?new((0,y.a)(n._apiEvent))({url:G,name:Z,pillar:(null==V?void 0:V.pillar)?V.pillar:void 0,veto:(null==V?void 0:V.veto)?V.veto:void 0}):new n._apiEvent({url:G,name:Z});var t=w&&w.now();se.getServerDataFromUrl({url:o,successCallback:r(e,t),failureCallback:l(e,t),uploadProgressCallback:U,additionalPostData:E,method:k,additionalHeaders:ee,contentType:A,withCredentials:!S&&void 0,noRedirect:J,responseType:T,needsRequestDigest:$})}()},maxRetries:P,noTimeoutInLastRetry:R,canRetry:function(){return B},onCancel:function(e){se&&(se.abort(),e&&se.dispose())}}).then(function(e){return se&&se.dispose(),e},function(e){return se&&se.dispose(),!re.endTime&&D.a.isCanceled(e)&&re.end({resultCode:p.b,resultType:c.b.ExpectedFailure}),D.a.reject(e)})};return S?D.a.resolve(S).then(function(e){return K({url:o,authToken:e})}):(null==q?void 0:q.authToken)?D.a.resolve(q.authToken).then(function(e){return K({url:o,authToken:e})}):Q?null==Y?void 0:Y({apiEvent:n._apiEvent,getData:K,options:{url:o,authToken:t.authToken,qosExtraData:t.qosExtraData,claimsChallenge:t.claimsChallenge},webAbsoluteUrl:N||q&&q.webAbsoluteUrl,qosName:Z,tokenProvider:Q}):(null==q?void 0:q.getAuthToken)?D.a.resolve(q.getAuthToken()).then(function(e){return K({url:o,authToken:e})}):K({url:o})},ee={authToken:t.authToken,telemetryHandler:t.telemetryHandler,url:t.url,useExactAuthToken:t.useExactAuthToken,method:t.method,additionalHeaders:t.additionalHeaders};return this._dataSyncClient&&!t.skipSyncClient?null==J?void 0:J({options:ee,aadUserId:null==q?void 0:q.aadUserId,dataSyncClient:this._dataSyncClient,getData:$}):$(ee)},e}()}
,777:(e,t,n)=>{n.d(t,{a:()=>o});var a=n(776),i=n(2),r=n(18);function o(e){var t=e.options,n=t.url,o=t.authToken,s=t.telemetryHandler,c=t.useExactAuthToken,d=t.method,l=t.additionalHeaders,u=e.dataSyncClient,f=e.aadUserId,p=e.getData,m=function(){return p({url:n,telemetryHandler:s,authToken:o,useExactAuthToken:c})};return i.a.isActivated("26fb0edf-b3af-42db-b8ea-2858c7eacfe0")&&!f?m():r.c.resolve(u).then(function(e){return e?function(e){var t=(0,a.a)(e,s);return e.getData({url:n,method:d,additionalHeaders:l},function(e){var n=e.endpoint,a=e.headers,i=e.onComplete;return p({url:n.url,authToken:n.authToken,telemetryHandler:function(e){return t(e,n,i)},useExactAuthToken:!0,additionalHeaders:a})},m)}(e):m()})}}
,778:(e,t,n)=>{n.d(t,{a:()=>f});var a=n(0),i=n(159),r=n(370),o=n(76),s=n(127),c=n(2),d=n(439),l=n(49),u=n(18);function f(e){var t=e.options,n=e.webAbsoluteUrl,r=e.apiEvent,f=e.tokenProvider,p=e.getData,g=e.qosName,v=t.url,y=new o.a(v),S="".concat(y.authority,"/{ length: ").concat(y.path.length,", segments: ").concat(y.segments.length," }"),D=function(e,t){if(!f.getAuthToken)return u.c.resolve({authToken:void 0});var n=new r({name:"".concat(g,".getAuthToken").concat(t?".retry":""),url:S});return u.c.resolve(f.getAuthToken(e)).then(function(e){return e&&"string"!=typeof e?(n.end({resultType:i.b.Success,resultCode:e.authToken?"tokenAuth":"cookieAuth",extraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}}),e):(n.end({resultType:i.b.Success,resultCode:e?"tokenAuth.string":"cookieAuth.string"}),{authToken:e})}).catch(function(e){return n.end((0,s.a)(e)),u.c.reject(e)})},I=function(e,t){if(!f.getFormDigest)return u.c.resolve(void 0);var n=new r({name:"".concat(g,".getAuthToken").concat(t?".retry":""),url:S});return u.c.resolve(f.getFormDigest(e)).then(function(e){return n.end({resultType:i.b.Success,resultCode:e?"newDigest":"sameDigest"}),e}).catch(function(e){return n.end((0,s.a)(e)),u.c.reject(e)})};if(!D&&!I)return p({url:v});var x={url:v,webAbsoluteUrl:n,claimsChallenge:t.claimsChallenge,apiQosName:g},C={url:v,webAbsoluteUrl:n,claimsChallenge:t.claimsChallenge};return D(x,!1).then(function(e){return e.authToken?e:I(C,!1).then(function(t){return e})}).then(function(e){if(e.authToken&&n&&(c.a.isActivated("BCE56589-7ADA-489E-B936-97BC6F63C8CA")||"/"!==v[0])&&!(0,d.a)(v,encodeURI(n)))throw new l.a({code:"TargetUrlDoesNotBeginWithWebAbsoluteUrl"});return p({url:v,authToken:e.authToken,qosExtraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}}).catch(function(t){var n;if(_(t))n={claimsChallenge:{authToken:e.authToken,claims:m(t),error:t}};else{if(!b(t)&&!h(t))return u.c.reject(t);n={expiration:{authToken:e.authToken,error:t}}}return D((0,a.__assign)((0,a.__assign)({},x),n),!0).then(function(n){if(!n.authToken){var i=void 0;if(_(t))i={claimsChallenge:{claims:m(t),error:t}};else{if(!b(t)&&!h(t))return u.c.reject(t);i={expiration:{error:t}}}return I((0,a.__assign)((0,a.__assign)({},C),i),!0).then(function(e){return n})}return n.authToken===e.authToken?u.c.reject(t):n}).then(function(e){return p({url:v,authToken:e.authToken,qosExtraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}})}).catch(function(e){return u.c.reject(e)})})})}var p="Bearer";function m(e){var t=e.authenticate,n='claims="';if(t){var a=t.indexOf(n);if(a>-1){var i=t.indexOf('"',a+n.length);if(i>-1){var r=t.slice(a+n.length,i);return c.a.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?r:atob(r)}}}}function _(e){var t=e.authenticate;return!!(t&&t.slice(0,p.length)===p&&t.indexOf('error="insufficient_claims"')>-1)}function h(e){return!!e.authenticate}function b(e){var t,n,a=e.code,i=e.status,o=e.codes,s=null===(n=null===(t=null==o?void 0:o.map)||void 0===t?void 0:t[r.b.subStatusCode])||void 0===n?void 0:n.code;return"3000002,invalid_client"===a||"10013"===a||(c.a.isActivated("F0F70DF0-2FB0-49BD-B40D-E66B0A1D566A")||401===i||"16"===s)&&"917656"===a}}
,776:(e,t,n)=>{n.d(t,{a:()=>o});var a=n(0),i=n(14),r=n(2);function o(e,t){return function(n,o,s){var c,d=n.eventData,l=d.extraData,u=void 0===l?{}:l,f={performanceEntry:u&&u.performanceEntry,httpStatus:u&&u.HttpStatus,responseHeaders:null===(c=n.serverData)||void 0===c?void 0:c.getResponseHeadersDictionary(),correlationId:u&&u.CorrelationId,succeeded:d&&d.resultType===i.b.Success||!1,resultCode:d&&d.resultCode,extraData:u},p=t&&t(n),m=r.a.isActivated("97E1912E-09BC-4111-9A67-EEA52ACC4BF3")?e.onRequestComplete(o,f):s(f);return u.dataSyncQos=e.getQosInfo(),(0,a.__assign)((0,a.__assign)({},p||{}),{eventData:(0,a.__assign)((0,a.__assign)({},p?p.eventData:d),{extraData:(0,a.__assign)((0,a.__assign)({},p?p.eventData.extraData:d.extraData),e.getQosInfo())}),canRetry:m&&(!p||p.canRetry)})}}}
,376:(e,t,n)=>{n.d(t,{a:()=>o,b:()=>r});var a=n(0),i=n(49),r={unknown:"Unknown",spServiceResponse:"SPServiceResponse"},o=function(e){function t(n){var i=this,r=n.errorData,o=n.innerError instanceof t&&n.innerError.errorData,s=n.errorData||o||{status:0},c=s.message,d=void 0===c?void 0:c,l=s.correlationId,u=void 0===l?void 0:l,f=s.code,p=void 0===f?void 0:f,m=(0,a.__rest)(s,["message","correlationId","code"]),_="object"==typeof d?d?JSON.stringify(d):"".concat(d):d,h=r&&r.codes||{order:[],map:{}};if(o&&o.codes)for(var b=0,g=o.codes.order;b<g.length;b++){var v=g[b];h.map[v]||(h.order.push(v),h.map[v]=o.codes.map[v])}var y=(0,a.__assign)((0,a.__assign)((0,a.__assign)((0,a.__assign)((0,a.__assign)({},"string"==typeof u?{correlationId:u}:{}),"string"==typeof p?{code:p}:{}),"string"==typeof _?{message:_}:{}),n),{extraData:(0,a.__assign)((0,a.__assign)({},n.extraData||{}),{hasAuthChallenge:!!s.authenticate,status:s.status,infected:s.infected,groupThrottle:s.groupThrottle,statusText:s.statusText})});(i=e.call(this,y)||this).name="GetDataError",i.codes=h,i.errorData=s;for(var S=0,D=Object.keys(m);S<D.length;S++)i[v=D[S]]=m[v];return i}return(0,a.__extends)(t,e),t}(i.a)}
,775:(e,t,n)=>{n.d(t,{a:()=>s,b:()=>c});var a,i,r,o,s=n(33).d.isFeatureEnabled({ODB:62073});try{o=null!==(r=null===(i=null===(a=null===window||void 0===window?void 0:window.UASContext)||void 0===a?void 0:a.workloadExtension)||void 0===i?void 0:i.toLowerCase().startsWith("/sharepoint"))&&void 0!==r&&r}catch(e){o=!1}var c=o}
,634:(e,t,n)=>{n.d(t,{a:()=>L,b:()=>k});var a=n(0),i=n(18),r=n(1087),o=n(159),s=n(56),c=n(1869),d=n(14),l=n(310),u=n(49),f=n(76),p=n(861),m=n(376),_=n(604),h=n(370),b=n(775),g=n(684),v=(n(776),n(777)),y=n(161),S=n(2),D=n(778),I=n(293),x=n(668),C=n(1444),O=n(70),w=S.a.isActivated("cb77018d-603a-46a1-8ddf-5a8f4e2fee2f"),E="undefined"!=typeof window?window:void 0,A=E&&E.performance,L=function(){function e(e,t){var n,i,r,c,d,l,u,f,p,m;if(w)this._pageContext=t?t.pageContext:e.pageContext,this._tokenProvider=null!==(i=null==t?void 0:t.tokenProvider)&&void 0!==i?i:null===(r=this._pageContext)||void 0===r?void 0:r.tokenProvider,this._dataSyncClient=null!==(c=null==t?void 0:t.dataSyncClient)&&void 0!==c?c:null===(d=this._pageContext)||void 0===d?void 0:d.dataSyncClient,this._qosName=e.qosName,this._apiEvent=null!==(l=null==t?void 0:t.apiEvent)&&void 0!==l?l:o.a,this._engagement=null!==(u=null==t?void 0:t.engagement)&&void 0!==u?u:s.a,this._normalizeErrors=!!e.normalizeErrors,this._getDataWithTokenProvider=null!==(f=null==t?void 0:t.getDataWithTokenProvider)&&void 0!==f?f:D.a,this._getDataWithSyncClient=null!==(p=null==t?void 0:t.getDataWithSyncClient)&&void 0!==p?p:v.a,this._offlineDetection=null==t?void 0:t.offlineDetection,this._noRedirect=null!==(m=null==t?void 0:t.noRedirect)&&void 0!==m?m:!!(null==t?void 0:t.tokenProvider)||void 0;else{var _=t?t.pageContext:e.pageContext;this._dataRequestorNew=new C.a((0,a.__assign)((0,a.__assign)({},e),{normalizeErrors:!!e.normalizeErrors}),(0,a.__assign)((0,a.__assign)({},t||{}),{dataRequestorContext:_,noRedirect:null!==(n=null==t?void 0:t.noRedirect)&&void 0!==n?n:!!(null==t?void 0:t.tokenProvider)}))}}return e.parseJSON=function(e){return e&&JSON.parse(e)||void 0},e.prototype.getData=function(e){if(void 0!==this._dataRequestorNew){var t,n,r=function(){e.onBeforeRequest&&e.onBeforeRequest();var t=l.b.getRUMOneLogger(),n=Date.now();t&&(t.readTempData("appDataFetchStart")||t.saveTempData("appDataFetchStart",n))};if(e.cancelToken)return i.c.resolve(this._dataRequestorNew.getData((0,a.__assign)((0,a.__assign)({},e),{onBeforeRequest:r})));var o=new O.b;return this._dataRequestorNew.getData((0,a.__assign)((0,a.__assign)({},e),{onBeforeRequest:r,cancelToken:o.token})).then(function(e){null==t||t(e),null==o||o.dispose()}).catch(function(e){null==n||n(e),null==o||o.dispose()}),new i.c(function(e,a){t=e,n=a},function(){o.cancel()})}var s=this._oldGetData(e);return e.cancelToken?i.c.resolve((0,c.a)(s,e.cancelToken)):s},e.prototype._oldGetData=function(t){var n=this,o=t.parseResponse,s=void 0===o?e.parseJSON:o,c=t.qosExtraData,v=t.additionalPostData,D=void 0===v?"":v,C=t.contentType,O=t.method,w=void 0===O?"POST":O,L=t.maxRetries,k=void 0===L?0:L,M=t.responseType,P=t.onUploadProgress,T=t.timeout,U=t.noTimeoutInLastRetry,F=void 0!==U&&U,H=t.webAbsoluteUrl,R=t.allowOAuth,N=void 0===R||R,B=t.customerPromise,j=t.url,V=t.maxUrlLength,z=void 0===V?2e3:V;if(j.length>z)throw new m.a({errorData:{code:"".concat(x.a,",").concat(_.h),status:-1}});var G=this._pageContext,K=this._tokenProvider,W=this._getDataWithTokenProvider,q=this._getDataWithSyncClient,Q=[];this._qosName&&Q.push(this._qosName),t.qosName&&Q.push(t.qosName);var Y=Q.join("."),J=function(e){var o=e.url,v=e.telemetryHandler,x=e.authToken,O=e.useExactAuthToken,L=void 0!==O&&O,U=e.additionalHeaders,R=!0,j=new f.a(o),V="".concat(j.authority,"/{ length: ").concat(j.path.length,", segments: ").concat(j.segments.length," }"),z=function(e){var x=e.authToken,O=e.qosExtraData,j=t.crossSiteCollectionCall,z=void 0!==j&&j,W=t.noRedirect,q=void 0===W?n._noRedirect:W,Q=t.needsRequestDigest,J=void 0===Q||Q,X=(0,a.__assign)((0,a.__assign)((0,a.__assign)({},t.additionalHeaders),U),{CollectSPPerfMetrics:h.b.sqlQueryCount});if(N&&x){var Z=!1;y.a.isFeatureEnabled({ECS:86137})||x.split(" ").length>1&&(Z=!0);var $=L||Z?x:"Bearer ".concat(x),ee=!1;for(var te in X)te&&"authorization"===te.toLowerCase()&&(ee=!0);ee||(X.Authorization=$),z=!0,J=!1,q=!0}else N&&(b.a&&b.b||!K||K&&(X.Authorization="Bearer"));var ne,ae,ie=new g.a((0,a.__assign)((0,a.__assign)({},G?{webServerRelativeUrl:G.webServerRelativeUrl,webAbsoluteUrl:H||G.webAbsoluteUrl,alwaysGetDigest:z,formDigest:{serverTime:G.serverTime,updateFormDigestPageLoaded:G.updateFormDigestPageLoaded,formDigestValue:G.formDigestValue,formDigestTimeoutSeconds:G.formDigestTimeoutSeconds}}:{}),{needsRequestDigest:J,engagement:n._engagement,operationName:n._qosName})),re=E&&E.location&&new f.a(E.location.href).authority,oe=new f.a(o).authority,se=l.b.getRUMOneLogger(),ce=Date.now();return se&&(se.readTempData("appDataFetchStart")||se.saveTempData("appDataFetchStart",ce)),function(e){var t=e.onExecute,n=e.onCancel,a=e.timeout,o=e.canRetry,s=e.noTimeoutInLastRetry,c=0,d=Math.max(e.maxRetries,0),l=function(){var e=new i.c(t,function(){n(c>=d||!o())});return a&&(!s||c<d)?i.c.timeout(a,e):e};return c<d?(0,r.a)({canRetry:o,retries:d,callback:l,beforeRetry:function(){c++}}):l()}({timeout:T,onExecute:function(e,t){var i=function(i,r){return function(l){var u=l.getResponseText();ae=l.getServiceWorkerDataSourceHeader();var f,_,b,g,y=(0,p.a)(o,r),S=(0,a.__assign)((0,a.__assign)((0,a.__assign)((0,a.__assign)({},c||{}),{needsRequestDigest:J,hasAuthToken:!!x,isCrossOrigin:!!re&&re!==oe,CorrelationId:l.getCorrelationId()}),O||{}),{HttpStatus:l.getStatus(),serviceWorkerDataSource:ae||void 0,rawRequestDuration:y.duration,performanceEntry:JSON.stringify(y),serviceWorkerFetchInfo:l.getResponseHeader(h.b.serviceWorkerFetchInfo)||void 0,SQLRT:l.getHeaderNumberValue(h.b.sqlQueryCount),ServerDuration:l.getHeaderNumberValue(h.b.serverDuratrion)}),D=!1;try{!function(e,t){return"blob"===e&&t&&"object"==typeof t}(M,u)?_=s(u,l):b=u,D=!0}catch(e){f=e,g={resultType:d.b.Failure,resultCode:"InvalidJSON",error:"object"==typeof e?JSON.stringify(e):e,extraData:S}}if(g||(g={resultType:d.b.Success,extraData:S}),v&&(g=v({response:_,eventData:g,serverData:l}).eventData),i.end(g),D)try{e(b||_)}catch(e){}else t(n._normalizeErrors?new m.a({code:"-1,parse_response",innerError:f,errorData:{correlationId:l.getCorrelationId(),status:l.getStatus()}}):void 0);ie=void 0}},r=function(e,i){return function(r,s){var l=(0,p.a)(o,i),f=(0,a.__assign)((0,a.__assign)({},c||{}),{needsRequestDigest:J,hasAuthToken:!!x,isCrossOrigin:!!re&&re!==oe,rawRequestDuration:l.duration,performanceEntry:JSON.stringify(l)}),b="undefined"!=typeof navigator&&!1===navigator.onLine;if(n._offlineDetection&&(b=n._offlineDetection.offline),!r){var g=_.g,y=!0,I=0;s&&s instanceof u.a&&(g=s.code,y=s.isExpected,I=-1),!b||g!==_.d&&g!==_.g||(g=_.e);var C={status:I,code:g},O={resultType:y?d.b.ExpectedFailure:d.b.Failure,resultCode:g,extraData:f};return v&&(O=v({eventData:O,errorData:C}).eventData),e.end(O),void t(n._normalizeErrors?new m.a({errorData:C,innerError:s}):C)}var w=function(i){var o=void 0,s=function(e){var t=!1,n={order:[],map:{}},a=e.getResponseHeader(h.b.msDiagnostics);if(a)try{var i=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?/.exec(a),r=i[1],o=void 0===r?"-1":r,s=i[2],c=void 0===s?"":s,d=i[3],l=void 0===d?"unknown":d;switch(Number(o)){case 3e6:case 3000003:case 3000006:case 3001003:case 3001004:case 3001005:case 3002e3:case 3004009:case 3004010:case 3003e3:t=!0;break;default:t=!1}var u={source:h.b.msDiagnostics,code:"".concat(o,",").concat(l),message:c,isDisplayable:!0};n.order.push(u.source),n.map[u.source]=u}catch(e){}var f=e.getResponseHeader(h.b.webDavExtError);if(f)try{var p=/(\d+);\s+(.+)/.exec(f),m=p[1],_=void 0===m?"-1":m,b=p[2];c=void 0===b?"":b,u={source:h.b.webDavExtError,code:_,message:c,isDisplayable:!1},n.order.push(u.source),n.map[u.source]=u}catch(e){}var g=e.getResponseHeader(h.b.spoErrorCode);if(g){var v=e.getResponseHeader(h.b.spoErrorMessage);u={source:h.b.spoErrorCode,code:g,message:v,isDisplayable:!0},n.order.push(u.source),n.map[u.source]=u}var y=e.getResponseHeader(h.b.subStatusCode);return y&&(u={source:h.b.subStatusCode,code:y},n.order.push(u.source),n.map[u.source]=u),{codes:n,isExpected:t}}(r),c=s.isExpected,l=s.codes;if("object"==typeof i&&"number"==typeof i.status)o=i;else if("string"==typeof i){var u=void 0;try{u=JSON.parse(i)}catch(e){}if(u)if(u.error_description)o={code:"-1,".concat(u.error||"Unknown"),message:u.error_description},"policy_enforced"===u.error&&(c=!0);else if("string"==typeof u.error)o={message:u.error};else if(u.error&&u.error.message&&u.error.message.value){var p={source:m.b.spServiceResponse,code:u.error.code,message:"".concat(u.error.message.value),isDisplayable:!0};l.order.push(p.source),l.map[p.source]=p,o=u.error}else o=u.error||u["odata.error"]||{responseData:u};else if(i&&400===r.getStatus()){var g;g=function(e){return/<html[^>]*>[\s\S]*?<body[^>]*>[\s\S]*?<\/body>[\s\S]*?<\/html>/i.test(e)}(i)?function(e){var t=e.match(/<body[^>]*>[\s\S]*<\/body>/i);return t?t[0]:""}(i).slice(0,1e3):i.slice(0,1e3),o={code:"-1,HTMLResult",message:g},f=(0,a.__assign)((0,a.__assign)({},f),{rawPayload:D})}}var y=r.getStatus(),I=r.getCorrelationId(),x=r.getResponseHeader(h.b.spGroupThrottle),C=r.getResponseHeader(h.b.webDavExtError);if(f=(0,a.__assign)((0,a.__assign)({},f),{CorrelationId:I,HttpStatus:y,GroupThrottle:x,MSCorrelationVector:r.getResponseHeader(h.b.correlationVector)}),(401===y&&C||403===y||404===y||429===y||503===y||-1===y||0===y&&b)&&(R=!1,c=!0),400===y){var O=function(e){var t,n={order:[],map:{}},a="No X-Msedge-Ref details",i=e.getResponseHeader(h.b.msEdgeRef);return i?t={source:h.b.subStatusCode,code:"Non-Empty X-Msedge-Ref details",message:i}:S.a.isActivated("44F48045-1E39-41C1-962A-7F04F8093447")&&(t={source:h.b.subStatusCode,code:a,message:a}),t&&(n.order.push(t.source),n.map[t.source]=t),{codes:n,isExpected:!1}}(r);Array.prototype.push.apply(l.order,O.codes.order),O.codes.order.forEach(function(e){l.map[e]=O.codes.map[e]}),f.rawPayload||(f=(0,a.__assign)((0,a.__assign)({},f),{rawPayload:D}))}(o=o||{}).codes=l,o.status=y,o.retryAfter=r.getHeaderNumberValue(h.b.retryAfter),o.authenticate=r.getResponseHeader(h.b.authenticate),o.authenticate&&(c=!0),I&&(o.correlationId=I),x&&(o.groupThrottle=x);var w=JSON.stringify(o);S.a.isActivated("C17CE162-3524-444F-85D5-8B5A0AA35544")||(o.targetUrl=r.getSourceUrl());var E=o["@error.redirectUrl"],A=r.getRedirectUrl()||E;A&&(c=!0,o.redirectUrl=A);var L=l.map[m.b.spServiceResponse];L&&n._normalizeErrors&&(o.message=L.message);var k=l.order[0];k&&(p=l.map[k])&&(k===h.b.spoErrorCode&&p.message?(o.code=_.a,o.message=p.message):p.code&&(o.code=p.code)),o.code||(o.code=_.g);var M="[".concat(y,"] ").concat(o.code),P={resultType:c?d.b.ExpectedFailure:d.b.Failure,error:w,resultCode:M,extraData:f};if(v){var T=v({eventData:P,errorData:o,serverData:r}),U=T.eventData,F=T.canRetry;U&&(P=U),!0!==F&&!1!==F||(R=F),P.resultType===d.b.ExpectedFailure&&(c=!0)}var H=n._normalizeErrors?new m.a({errorData:o,isExpected:c}):o;H.codes&&H.codes&&(P.extraData.errorCodes=JSON.stringify(H.codes.map)),e.end(P),t(H)},E=r.getResponseType();E&&"text"!==E?r.parseError().then(w):w(r.getResponseText())}};!function(){var e;e=ne=B?new((0,I.a)(n._apiEvent))({url:V,name:Y,pillar:(null==B?void 0:B.pillar)?B.pillar:void 0,veto:(null==B?void 0:B.veto)?B.veto:void 0}):new n._apiEvent({url:V,name:Y});var t=A&&A.now();ie.getServerDataFromUrl({url:o,successCallback:i(e,t),failureCallback:r(e,t),uploadProgressCallback:P,additionalPostData:D,method:w,additionalHeaders:X,contentType:C,withCredentials:!x&&void 0,noRedirect:q,responseType:M,needsRequestDigest:J})}()},maxRetries:k,noTimeoutInLastRetry:F,canRetry:function(){return R},onCancel:function(e){ie&&(ie.abort(),e&&ie.dispose())}}).then(function(e){return ie&&ie.dispose(),e},function(e){return ie&&ie.dispose(),!ne.endTime&&i.c.isCanceled(e)&&ne.end({resultCode:_.b,resultType:d.b.ExpectedFailure}),i.c.reject(e)})};return x?i.c.resolve(x).then(function(e){return z({url:o,authToken:e})}):(null==G?void 0:G.authToken)?i.c.resolve(G.authToken).then(function(e){return z({url:o,authToken:e})}):K?W({apiEvent:n._apiEvent,getData:z,options:{url:o,authToken:t.authToken,qosExtraData:t.qosExtraData,claimsChallenge:t.claimsChallenge},webAbsoluteUrl:H||G&&G.webAbsoluteUrl,qosName:Y,tokenProvider:K}):(null==G?void 0:G.getAuthToken)?i.c.resolve(G.getAuthToken()).then(function(e){return z({url:o,authToken:e})}):z({url:o})},X={authToken:t.authToken,telemetryHandler:t.telemetryHandler,url:t.url,useExactAuthToken:t.useExactAuthToken,method:t.method,additionalHeaders:t.additionalHeaders};return this._dataSyncClient&&!t.skipSyncClient?q({options:X,aadUserId:null==G?void 0:G.aadUserId,dataSyncClient:this._dataSyncClient,getData:J}):J(X)},e}();const k=L}
,1869:(e,t,n)=>{n.d(t,{a:()=>i});var a=n(0);function i(e,t){return(0,a.__awaiter)(this,void 0,void 0,function(){var n,i,r;return(0,a.__generator)(this,function(a){switch(a.label){case 0:n=t.subscribe(function(){e.cancel()}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,e];case 2:return i=a.sent(),n(),[2,i];case 3:throw r=a.sent(),n(),r;case 4:return[2]}})})}}
,1087:(e,t,n)=>{n.d(t,{a:()=>i});var a=n(103);function i(e){var t,n=e.adjustRetries,i=e.async,r=e.beforeRetry,o=e.callback,s=e.canRetry,c=void 0===s?function(){return!0}:s,d=e.delay,l=e.resetAttemptsOnRestart,u=e.shouldRestart,f=e.retries,p=0,m=new a.b(function(){t.cancel()});function _(e){u&&u()?(l&&(p=0),b()):m.complete(e)}function h(e){n&&(f=n(e)),p<f&&c(e)?(p++,r&&r(),"number"==typeof d&&i?i.setTimeout(b,d):b()):m.error(e)}function b(){(t=o()).then(_,h)}return b(),m.getPromise()}}
}]),define("shared-split-bundle~698df558",[],{});